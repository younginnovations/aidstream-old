<?php
    $enabledBlocks = $this->blockManager()->getEnabledBlocks();
    $dataBlocks = array(
        'partial/primarymenu.phtml',
        'partial/add-activity-menu.phtml',
        'partial/organisation-menu.phtml',
        'partial/organisation-data.phtml',
        'partial/published-list.phtml',
        'partial/download-my-data.phtml',
        'partial/superadmin-menu.phtml',
        'partial/simplified-info.phtml'
    );
    
    $managementBlocks = array(
        'partial/usermgmtmenu.phtml',
        'partial/uploaded-docs.phtml'
    );
    
    $otherBlocks = array(
        'partial/activitymenu.phtml'
    );
?>
<?php
    $hasDataBlock = false;
    $hasMgmtBlock = false;
    $hasOtherBlock = false;
    
    foreach($enabledBlocks as $block){
        if($hasDataBlock || in_array($block , $dataBlocks)){
            $hasDataBlock = true;
        }
        
        if($hasMgmtBlock || in_array($block , $managementBlocks)){
            $hasMgmtBlock = true;
        }
        
        if($hasOtherBlock || in_array($block , $otherBlocks)){
            $hasOtherBlock = true;
        }
    }
?>
<?php if($hasDataBlock) : ?>
    <div class="data-block">
        <?php foreach($dataBlocks as $dataBlock): ?>
            <?php print $this->blockManager()->get($dataBlock); ?>
        <?php endforeach; ?>
    </div>
<?php endif; ?>
<?php if($hasMgmtBlock): ?>
    <div class='management-block'>
        <?php foreach($managementBlocks as $managemaneBlock): ?>
            <?php print $this->blockManager()->get($managemaneBlock); ?>
        <?php endforeach;?>
    </div>
<?php endif; ?>
<?php if($hasOtherBlock) : ?>
    <div class='other'>
        <?php foreach($otherBlocks as $otherBlock): ?>
            <?php print $this->blockManager()->get($otherBlock); ?>
        <?php endforeach; ?>
    </div>
<?php endif;?>